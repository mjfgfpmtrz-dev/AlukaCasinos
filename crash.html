<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<title>AlukaCase — Crash</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  background: radial-gradient(circle at top, #0f1b2d, #060b16);
  color: #fff;
  font-family: -apple-system, BlinkMacSystemFont, sans-serif;
  overflow: hidden;
}

/* TOP */
.top {
  display: flex;
  justify-content: flex-end;
  padding: 16px;
}

.balance {
  background: #121f35;
  padding: 8px 14px;
  border-radius: 14px;
  font-weight: 600;
}

/* CENTER */
.center {
  position: absolute;
  inset: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}

.multiplier {
  font-size: 56px;
  font-weight: 800;
  margin-bottom: 20px;
}

.last {
  margin-top: 8px;
  color: #ff5c5c;
  font-weight: 600;
}

/* ROCKET */
.rocket {
  width: 110px;
  height: 110px;
  margin-top: 20px;
  transition: transform 0.05s linear;
}

.rocket svg {
  width: 100%;
  height: 100%;
  fill: white;
}

/* EXPLOSION */
.explosion {
  width: 140px;
  height: 140px;
  border-radius: 50%;
  background: radial-gradient(circle, #ffb300, #ff3d00, transparent);
  animation: boom 0.6s ease-out forwards;
}

@keyframes boom {
  from { transform: scale(0.3); opacity: 1; }
  to { transform: scale(2); opacity: 0; }
}

/* BOTTOM */
.bottom {
  position: absolute;
  bottom: 20px;
  width: 100%;
  padding: 0 16px;
}

.button {
  width: 100%;
  background: #2f7cff;
  border: none;
  color: #fff;
  font-size: 18px;
  padding: 16px;
  border-radius: 16px;
  font-weight: 700;
}
.button.red {
  background: #ff4d4d;
}
.button.gray {
  background: #3a425a;
}
</style>
</head>

<body>

<div class="top">
  <div class="balance">TON <span id="balance">100.00</span></div>
</div>

<div class="center">
  <div class="multiplier" id="multiplier">1.00x</div>

  <div class="rocket" id="rocket">
    <svg viewBox="0 0 24 24">
      <path d="M12 2C8 6 7 10 7 14l-3 3v2l4-1c1 1 3 1 4 1s3 0 4-1l4 1v-2l-3-3c0-4-1-8-5-12z"/>
    </svg>
  </div>

  <div class="last" id="last"></div>
</div>

<div class="bottom">
  <button class="button" id="actionBtn">Ставка 1 TON</button>
</div>

<script>
let balance = 100;
let state = "WAIT";
let multiplier = 1;
let crashAt = 0;
let interval;
let betPlaced = false;

const balanceEl = document.getElementById("balance");
const multiplierEl = document.getElementById("multiplier");
const rocketEl = document.getElementById("rocket");
const btn = document.getElementById("actionBtn");
const lastEl = document.getElementById("last");

function randomCrash() {
  const r = Math.random();
  if (r < 0.55) return 1.3 + Math.random() * 0.9;
  if (r < 0.8) return 2.0 + Math.random() * 1.5;
  if (r < 0.95) return 3.5 + Math.random() * 1.5;
  return 6 + Math.random() * 2;
}

function startWait() {
  state = "WAIT";
  betPlaced = false;
  btn.textContent = "Ставка 1 TON";
  btn.className = "button";
  multiplierEl.textContent = "1.00x";
  multiplier = 1;
  rocketEl.style.transform = "rotate(0deg)";
  lastEl.textContent = "";

  setTimeout(startRound, 5000);
}

function startRound() {
  state = "FLY";
  crashAt = randomCrash();
  btn.textContent = betPlaced ? "Забрать" : "Ставка закрыта";
  btn.className = betPlaced ? "button" : "button gray";

  interval = setInterval(() => {
    multiplier += 0.01 + multiplier * 0.002;
    multiplierEl.textContent = multiplier.toFixed(2) + "x";
    rocketEl.style.transform = `rotate(${multiplier * 8}deg)`;

    if (multiplier >= crashAt) crash();
  }, 100);
}

function crash() {
  clearInterval(interval);
  state = "CRASH";
  multiplierEl.textContent = "";
  rocketEl.innerHTML = "<div class='explosion'></div>";
  lastEl.textContent = "Last: " + crashAt.toFixed(2) + "x";
  btn.textContent = "Ожидание...";
  btn.className = "button gray";

  setTimeout(() => {
    rocketEl.innerHTML = `
      <svg viewBox="0 0 24 24">
        <path d="M12 2C8 6 7 10 7 14l-3 3v2l4-1c1 1 3 1 4 1s3 0 4-1l4 1v-2l-3-3c0-4-1-8-5-12z"/>
      </svg>`;
    startWait();
  }, 2000);
}

btn.onclick = () => {
  if (state === "WAIT" && !betPlaced && balance >= 1) {
    balance -= 1;
    betPlaced = true;
    balanceEl.textContent = balance.toFixed(2);
    btn.textContent = "Отменить";
    btn.className = "button red";
  } else if (state === "WAIT" && betPlaced) {
    balance += 1;
    betPlaced = false;
    balanceEl.textContent = balance.toFixed(2);
    btn.textContent = "Ставка 1 TON";
    btn.className = "button";
  } else if (state === "FLY" && betPlaced) {
    balance += multiplier;
    balanceEl.textContent = balance.toFixed(2);
    betPlaced = false;
    btn.textContent = "Забрано";
    btn.className = "button gray";
  }
};

startWait();
</script>

</body>
</html>